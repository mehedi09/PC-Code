function $closeHovers(){var n=Web.HoverMonitor._instance;n&&n.close()}function $hoverOver(n,t){while(t-->0)n=n.parentNode;n.focus();$skipUnhover()}function $skipUnhover(){Web.HoverMonitor._instance._skipUnhover=!0}function $nextTabIndex(){var n=Web.HoverMonitor._instance;return n?n.nextTabIndex():-1}function $showHover(n,t,i,r){Web.HoverMonitor._instance.hover(n,t,i,r)}function $hideHover(){__ie6&&event.fromElement&&event.fromElement.tagName=="A"&&event.fromElement.parentNode.tagName=="DIV"||Web.HoverMonitor._instance.unhover()}function $selectItem(n,t){Web.HoverMonitor._instance.select(n,t)}function $toggleHover(){Web.HoverMonitor._instance.toggle()}function $preventToggleHover(){Web.HoverMonitor._preventToggleHover=!0}function $refreshHoverMenu(n){Web.HoverMonitor._instance.refresh(n)}function $activateItem(n,t,i){Web.HoverMonitor._instance.activate(n,t,i)}function $deactivateItem(n,t){Web.HoverMonitor._instance.deactivate(n,t)}function $registerItems(n,t,i,r,u){i==null&&(i=Web.HoverStyle.Auto);r==null&&(r=Web.PopupPosition.Left);u==null&&(u=Web.ItemDescriptionStyle.Inline);$unregisterItems(n);Web.HoverMonitor.Families[n]={items:t,style:i,position:r,itemDescriptionStyle:u}}function $unregisterItems(n){var t=Web.HoverMonitor.Families[n],i;if(t&&t.items){for(i=0;i<t.items.length;i++)t.items[i].dispose();Array.clear(t.items)}delete Web.HoverMonitor.Families[n]}Type.registerNamespace("Web");Web.Item=function(n,t,i){this._family=n;this._text=t;this._description=i;this._depth=0};Web.Item.prototype={get_family:function(){return this._family},get_text:function(){return this._text},set_text:function(n){this._text=n},get_description:function(){return this._description},set_description:function(n){this._description=n},get_url:function(){return this._url},set_url:function(n){this._url=n},context:function(n){if(arguments.length==0)return this._context;this._context=n},get_script:function(){return this._script},set_script:function(n,t){this._script=t==null?n:String._toFormattedString(!1,arguments)},get_cssClass:function(){return this._cssClass},set_cssClass:function(n){this._cssClass=n},get_disabled:function(){return this._disabled},set_disabled:function(n){this._disabled=n},get_group:function(){return this._group},set_group:function(n){this._group=n},get_selected:function(){return this._selected},set_selected:function(n){this._selected=n},get_children:function(){return this._children},get_confirmation:function(){return this._confirmation},set_confirmation:function(n){this._confirmation=n},get_dynamic:function(){return this._dynamic},set_dynamic:function(n){this._dynamic=n;this._cssClass=n?"Dynamic":"";this._disabled=n},get_depth:function(){return this._depth},get_parent:function(){return this._parent},get_path:function(){if(!this._path){var n=this._parent?this._parent.get_path()+"/":"";n+=this._parent?Array.indexOf(this._parent.get_children(),this):Array.indexOf(Web.HoverMonitor.Families[this._family].items,this);this._path=n}return this._path},get_id:function(){return this._id||(this._id=String.format("HoverMonitor${0}$Item${1}",this._family,this.get_path().replace(/\//g,"_"))),this._id},get_children:function(){return this._children},addChild:function(n){n._parent=this;this._children||(this._children=[],this._cssClass="Parent");n._depth=this._depth+1;Array.add(this._children,n)},dispose:function(){if(this._parent=null,this._children){for(var n=0;n<this._children;n++)this._children[n].dispose();Array.clear(this._children);this._children=null}},findChild:function(n){return Web.Item.find(this._family,n,this._children)}};Web.Item.find=function(n,t,i){var u,r,f,e;if(String.isNullOrEmpty(t))return null;if(!i){if(u=Web.HoverMonitor.Families[n],!u)return null;i=u.items}return(r=t.match(/^(\d+)(\/(.+?)$|$)/),!r)?null:(f=parseInt(r[1]),!i||f>=i.length)?null:(e=i[f],r[3]&&r[3].length>0?e.findChild(r[3]):e)};Web.Menu=function(n){Web.Menu.initializeBase(this,[n]);this.set_orientation(Web.MenuOrientation.Horizontal);this.set_cssClass("Menu");this.set_hoverStyle(Web.HoverStyle.Auto);this.set_itemDescriptionStyle(Web.ItemDescriptionStyle.ToolTip);this.set_popupPosition(Web.PopupPosition.Left)};Web.Menu.prototype={initialize:function(){Web.Menu.callBaseMethod(this,"initialize")},dispose:function(){for(var i,t=this.get_nodes(),n=0;n<t.length;n++)i=t[n],i.children&&$unregisterItems(this.get_id()+"_"+n);Web.Menu.callBaseMethod(this,"dispose")},updated:function(){var r,y,p,o,n,t,e,u,c,w,s,i,h,l,f,a,b,v,k;if(Web.Menu.callBaseMethod(this,"updated"),Web.Menu.MainMenuId||(Web.Menu.MainMenuId=this.get_id(),Web.Menu.MainMenuElemId=this._element.id),r=this.get_nodes(),y=Web.DataViewResources.Menu,r){if(p=this.get_presentationStyle(),p>0&&(typeof __tf=="undefined"||!(__tf!=4))){Sys.UI.DomElement.addCssClass(this._element,"menu "+(p==1?"two-level":"nav-button"));this._createMenu(r,this._element,1);return}for(o=null,n=0;n<r.length;n++)if(t=r[n],this._currentNode=t,t.children){for(e=this.get_id()+"_"+n,u=[],c=0;c<t.children.length;c++)Array.add(u,this._createItem(e,t.children[c]));this.set_items(u);$registerItems(e,u,this.get_hoverStyle(),this.get_popupPosition(),this.get_itemDescriptionStyle());t.selected&&(o=t)}if(this._render(r),this.get_showSiteActions()){if(e=this.get_id()+"_SiteActions",u=[],this._selectedItem)for(w=this._selectedItem.get_parent()?this._selectedItem.get_parent().get_children():Web.HoverMonitor.Families[this._selectedItem.get_family()].items,n=0;n<w.length;n++)s=w[n],String.isNullOrEmpty(s.get_url())||s==this._selectedItem||(i=new Web.Item(e,s.get_text(),s.get_description()),i.set_url(s.get_url()),i.set_cssClass(s.get_cssClass()),Array.add(u,i));if(u.length==0)for(!o||!o.children||o.children.length==1&&o.children[0].selected||(r=o.children),n=0;n<r.length;n++)t=r[n],String.isNullOrEmpty(t.url)||t.selected&&r.length!=1||(i=new Web.Item(e,t.title,t.description),i.set_url(t.url),i.set_cssClass(t.cssClass),Array.add(u,i));if($registerItems(e,u,Web.HoverStyle.ClickAndStay,Web.PopupPosition.Right,Web.ItemDescriptionStyle.Inline),Web.Menu._siteActionsFamily=e,h=$getSideBar(),h&&u.length>0){for(n=0;n<h.childNodes.length;n++)if(l=h.childNodes[n],l.className&&Sys.UI.DomElement.containsCssClass(l,"About")){l.getElementsByTagName("div")[1].innerHTML=y.About;break}for(f=new Sys.StringBuilder,f.append('<div class="Inner">'),f.appendFormat('<div class="Header">{0}<\/div>',y.SeeAlso),n=0;n<u.length;n++)if(i=u[n],String.isNullOrEmpty(i.get_url())||f.appendFormat('<div class="Item"><a href="{0}" title="{2}">{1}<\/a><\/div>',i.get_url(),String.trimLongWords(i.get_text()),String.trimLongWords(i.get_description())),n>5)break;f.append("<\/div>");a=document.createElement("div");a.className="TaskBox SeeAlso";a.innerHTML=f.toString();f.clear();h.insertBefore(a,h.childNodes[h.childNodes.length-1])}if(b=$get("TableOfContents"),b){for(f.append('<div class="TableOfContents">'),n=0;n<r.length;n++)t=r[n],f.appendFormat('<div class="Header">',t.get_text());f.append("<\/div>")}}else v=Web.PageState.read(this.get_id()),v!=null&&(k=this._element.getElementsByTagName("td"),this.select(v,k[v]))}},get_presentationStyle:function(){return this._presentationStyle},set_presentationStyle:function(n){this._presentationStyle=n},_createNewColumn:function(n,t,i){return n.cssClass&&n.cssClass.match(/(^|\s*)menu-new-column(\s*|$)/)?$("<div>").addClass("column "+i).appendTo(t):null},_createNavButton:function(n){var u=null,i=null,a=!1,v=!1,f=null,t,o,y,s,b,h,c,k,l,d;$("div.PageMenuBar").hide();t=$("<ul>").attr("id",this._id).addClass("root-level");o=$("<div>").addClass("menu-button-container").css({position:"absolute",height:"1px",left:"0px",top:"0px"});o.appendTo(document.body);t.appendTo(o);y=function(n,t){for(var r=0;r<n.length;r++){var i=n[r],u=$("<li>").appendTo(t),e=$("<a>").attr({href:i.url,title:i.description}).text(i.title).appendTo(u);i.selected&&!i.children&&(e.addClass("selected"),f=e);i.children&&i.children.length>0&&y(i.children,$("<ul>").addClass("menu-level").appendTo(u))}};y(n,t);var e=0,g=$("#"+this._id+" > li > a").each(function(){var n=$(this).outerWidth();n>e&&(e=n)}),r=$("#PageHeaderBar").addClass("menu-button-bar").contents().wrap('<span class="menu-button"><\/span>').parent().button({icons:{secondary:"ui-icon-triangle-1-s"}}),p=r.width()-4,w=t.find("ul").addClass("sub-level");for(s=w.length-1;s>=0;s--)b=$(w[s]),h=0,b.find("> li > a").each(function(){var n=$(this).outerWidth();n>h&&(h=n)}).width(h+25);t.find("ul").each(function(){$(this).find("ul").length==0&&$(this).addClass("last-level")});e+=25;p>e?t.width(p):t.width(e);c=function(){i||(i=setTimeout(function(){v||(t.hide(),r.removeClass("menu-button-active"));i=null},200))};k=function(){i&&(clearTimeout(i),i=null)};o.find("ul").hover(function(){v=!0},function(n){$(n.toElement).find("li:parent ul.menu-level:parent").length==0&&(v=!1,c())});t.menu({position:{of:"ul:has(a.ui-state-focus):last"},select:function(){},blur:function(){a||c()},focus:function(){i&&(clearTimeout(i),i=null);t.show()}});l=t.outerHeight();t.find("ul").show().each(function(){var n=$(this).outerHeight();n>l&&(l=n)}).andSelf().height(l).hide();t.hide();d=0;r.hover(function(){a=!0;k();u=setTimeout(function(){var i,n,e;if(r.addClass("menu-button-active"),t.show().position({my:"left top",at:"left bottom",of:r}),u=null,f){for(f.parentsUntil("div.menu-button-container","li").find("a:first").not("a.selected").addClass("ui-state-active"),t.show().position({my:"left top",at:"left bottom",of:r}),i=f.parentsUntil("div.menu-button-container","ul").show(),n=i.length-2;n>=0;n--)e=$(i[n]),e.position({my:"left top",at:"right top",of:$(i[n+1])});f=null}},500)},function(){a=!1;u&&(clearTimeout(u),u=null);c()})},_createMenu:function(n,t,i){var p=this._presentationStyle==2,h,e,o,f,r,v,c,l,u,s,a,w,b,k,y;if(i==1&&p){this._createNavButton(n);return}if(h=null,e="level"+i,i>1&&(t=$("<div>").addClass("children "+e).appendTo(t.first())),o=null,i==2)for(f=0;f<n.length;f++)if(r=n[f],o=this._createNewColumn(r,t,e),o){o.addClass("first");break}for(v=$("<ul>").addClass(e).appendTo(o?o:t),c=!0,f=0;f<n.length;f++)r=n[f],o&&f>0&&(l=this._createNewColumn(r,t,e),l&&(o=l,v=$("<ul>").addClass(e).appendTo(l),c=!0)),u=$("<li>").addClass(e).appendTo(v),r.selected&&(u.addClass("current"),h=r),f==0&&u.addClass("first"),f==n.length-1&&u.addClass("last"),s=r.url,String.isNullOrEmpty(s)&&i==1&&(s="javascript:void(0)"),String.isNullOrEmpty(s)?(b=$("<span>").addClass("text "+e).text(r.title).appendTo(u),c&&(c=!1,b.addClass("first"))):(a=$("<a>").attr({href:s,"class":e,tabIndex:$nextTabIndex()}).appendTo(u),s.match(Web.Menu.UrlRegex.match)&&(a.attr("menuItemUrl",s),a.click(function(n){n.preventDefault();Web.Menu.navigate(this.getAttribute("menuItemUrl"))})),w=$("<span>").addClass("outer").appendTo(a),$("<span>").addClass("inner").appendTo(w).text(r.title).attr("title",r.description)),i==1&&(p?u.hover(function(){var r=$(this).addClass("hover"),n;if(r.siblings("li").addClass("unhover"),n=$("div.level2:first",this),n.size()==1){var t=$(this).parents("div.nav-button.menu:first"),i=t.offset(),u=t.outerWidth(),f=t.outerHeight();i.left+=u;n.removeAttr("style").offset({left:0,top:0}).css("width","auto");n.removeAttr("style").offset(i)}},function(){var n=$(this).removeClass("hover").siblings("li").removeClass("unhover");$("div.level2:first",this).hide()}):u.hover(function(){var i=$(this).addClass("hover"),t,n,r;if(i.siblings("li").addClass("unhover"),$closeHovers(),t=$("div.level2:first",this),t.size()==1){n=i.offset();n.top+=i.outerHeight();var f=i.outerWidth(),u=$(window).width(),e=$(window).height();t.removeAttr("style").offset({left:0,top:0});r=t.outerWidth();n.left+r>u&&(n.left=u-r-10);n.left<0&&(n.left=0);t.hide().removeAttr("style").offset(n)}},function(){var n=$(this).removeClass("hover").siblings("li").removeClass("unhover");$("div.level2:first",this).hide()})),k=r.children&&r.children.length>0,k?(y=this._createMenu(r.children,u,i+1),y&&(h=y,u.addClass("selected")),u.addClass("parent"),i==1&&r.cssClass&&$("div.children:first",u).addClass(r.cssClass)):u.addClass("terminal"),i==2&&t.hide();return h},get_nodes:function(){return this._nodes||(this._nodes=Web.Menu.Nodes[this.get_id()]),this._nodes},set_nodes:function(n){this._nodes=n},get_orientation:function(){return this._orientation},set_orientation:function(n){this._orientation=n},get_cssClass:function(){return this._cssClass},set_cssClass:function(n){this._cssClass=n},get_hoverStyle:function(){return this._hoverStyle},set_hoverStyle:function(n){this._hoverStyle=n},get_itemDescriptionStyle:function(){return this._itemDescriptionStyle},set_itemDescriptionStyle:function(n){this._itemDescriptionStyle=n},get_popupPosition:function(){return this._popupPosition},set_popupPosition:function(n){this._popupPosition=n},get_showSiteActions:function(){return this._showSiteActions},set_showSiteActions:function(n){this._showSiteActions=n},get_items:function(){return this._items},set_items:function(n){this._items=n},_createItem:function(n,t,i){var r=new Web.Item(n,t.title,t.description),u;if(r.set_url(t.url),t.selected&&(r.set_selected(t.selected),this._currentNode.selected=!0,this._selectedItem=r),i&&i.addChild(r),t.children)for(u=0;u<t.children.length;u++)this._createItem(n,t.children[u],r);return r},_render:function(n){var t,r,i,u;for($("td.Item",this._element).unbind("mouseover mouseout click"),$("td.Item a.Link",this._element).unbind("click focus blur"),t=new Sys.StringBuilder,t.appendFormat('<table class="{0}" cellpadding="0" cellspacing="0" style="float:left">',this.get_cssClass()),this.get_orientation()==Web.MenuOrientation.Horizontal&&t.append("<tr>"),r=0;r<n.length;r++)i=n[r],this.get_orientation()==Web.MenuOrientation.Vertical&&t.append("<tr>"),t.appendFormat('<td class="Item{3}" onmouseover2="$showHover(this,&quot;{0}_{1}&quot;,&quot;{4}&quot;)" onmouseout2="$hideHover(this)" onclick2="if(this._skip)this._skip=false;else $find(&quot;{0}&quot).select({1},this);"{7}><span class="Outer"><span class="Inner"><span class="Link"><a href="javascript:" class="Link" onclick2="this.parentNode.parentNode.parentNode.parentNode._skip=true;$hoverOver(this, 4);$find(&quot;{0}&quot).select({1},this);return false;" onfocus2="$showHover(this,&quot;{0}_{1}&quot;,&quot;{4}&quot;, 4)" onblur2="$hideHover(this)" tabIndex="{6}" {5}>{2}<\/a><\/span><\/span><\/span><\/td>',this.get_id(),r,$appfactory.htmlEncode(i.title),(i.children?" Parent":"")+(i.selected?" Selected":""),this.get_cssClass(),String.isNullOrEmpty(i.description)||this.get_itemDescriptionStyle()==Web.ItemDescriptionStyle.None?"":String.format(' title="{0}"',$appfactory.htmlAttributeEncode(i.description)),$nextTabIndex(),i.hidden=="true"?' style="display:none"':""),this.get_orientation()==Web.MenuOrientation.Vertical&&t.append("<\/tr>");this.get_orientation()==Web.MenuOrientation.Horizontal&&t.append("<\/tr>");t.append("<\/table>");this.get_showSiteActions()&&(t.appendFormat('<table class="Menu SiteActions" cellpadding="0" cellspacing="0" style="float:right"><tr><td class="Item Parent" onmouseover2="$showHover(this,&quot;{0}_SiteActions&quot;,&quot;SiteActions&quot;)" onmouseout2="$hideHover(this)" onclick2="if(this._skip)this._skip=false;else $toggleHover()"><span class="Outer"><span class="Inner"><span class="Link"><a href="javascript:" class="Link" onclick2="this.parentNode.parentNode.parentNode.parentNode._skip=true;$toggleHover();$hoverOver(this, 4);return false" onfocus2="$showHover(this,&quot;{0}_SiteActions&quot;,&quot;SiteActions&quot;, 4)" onblur2="$hideHover(this)" tabIndex="{1}">{2}<\/a><\/span><\/span><\/span><\/td><\/tr><\/table>',this.get_id(),$nextTabIndex(),Web.DataViewResources.Menu.SiteActions),u=document.createElement("div"),this._element.parentNode.appendChild(u));this._element.innerHTML=t.toString();$("td.Item",this._element).mouseover(function(){return __evalEvent.call(this,"mouseover")}).mouseout(function(){return __evalEvent.call(this,"mouseout")}).click(function(n){return n.preventDefault(),__evalEvent.call(this,"click")});$("td.Item a.Link",this._element).click(function(n){return n.preventDefault(),__evalEvent.call(this,"click")}).focus(function(){return __evalEvent.call(this,"focus")}).blur(function(){return __evalEvent.call(this,"blur")});t.clear()},select:function(n,t){var r,u,i;if(_body_createPageContext(),r=this.get_nodes()[n],String.isNullOrEmpty(r.elementId))Web.Menu.navigate(r.url);else{for(Web.PageState.write(this.get_id(),n),u=$get(r.elementId),i=0;i<this.get_nodes().length;i++)r=this.get_nodes()[i],String.isNullOrEmpty(r.elementId)||Sys.UI.DomElement.setVisible($get(r.elementId),!1);for(Sys.UI.DomElement.setVisible(u,!0);!Sys.UI.DomElement.containsCssClass(t,"Item");)t=t.parentNode;for(i=0;i<t.parentNode.childNodes.length;i++)Sys.UI.DomElement.removeCssClass(t.parentNode.childNodes[i],"Selected");Sys.UI.DomElement.addCssClass(t,"Selected");_body_performResize();try{t.focus()}catch(f){}}}};Web.Menu.Nodes=[];Web.Menu.findNode=function(n,t){var r,i,u;for(t||(t=this.Nodes[this.MainMenuId]),r=0;r<t.length;r++){if(i=t[r],i.url.match(n))return i;if(i.children&&(u=Web.Menu.findNode(n,i.children),u))return u}return null};Web.Menu.get_siteActionsFamily=function(){return Web.Menu._siteActionsFamily};Web.Menu.get_siteActions=function(){return Web.HoverMonitor.Families[this._siteActionsFamily].items};Web.Menu.set_siteActions=function(n){Web.HoverMonitor.Families[this._siteActionsFamily].items=n};Web.Menu.UrlRegex=/^(_.+?):(.+?)$/;Web.Menu.navigate=function(n){if(!String.isNullOrEmpty(n)){var t=n.match(Web.Menu.UrlRegex);t?window.open(t[2],t[1]):($appfactory._navigated=!0,location.href=n)}};Web.Menu.registerClass("Web.Menu",Sys.UI.Behavior);Web.HoverStyle={None:0,Auto:1,Click:2,ClickAndStay:3};Web.PopupPosition={Left:0,Right:1};Web.MenuOrientation={Horizontal:0,Vertical:1};Web.ItemDescriptionStyle={None:0,Inline:1,ToolTip:2};Web.HoverMonitor=function(){Web.HoverMonitor.initializeBase(this);this._popups=[]};Web.HoverMonitor.prototype={initialize:function(){Web.HoverMonitor.callBaseMethod(this,"initialize");this._hoverArrowHandlers={click:this._hoverArrow_click,mouseover:this._hoverArrow_mouseover,mouseout:this._hoverArrow_mouseout};this._hoverMenuHandlers={mouseover:this._hoverMenu_mouseover,mouseout:this._hoverMenu_mouseout};this._documentKeydownHandler=Function.createDelegate(this,this._document_keydown);this._documentClickHandler=Function.createDelegate(this,this._document_click);$addHandler(document,"keydown",this._documentKeydownHandler);$addHandler(document,"click",this._documentClickHandler);this._tabIndex=1},dispose:function(){delete this._factory;for(var n=0;n<Web.HoverMonitor.Families.length;n++)$unregisterItems(Web.HoverMonitor.Families[n].family);for($removeHandler(document,"click",this._documentClickHandler),$removeHandler(document,"keydown",this._documentKeydownHanlder),this.stopClose(),this.stopCloseItem(),this.stopOpen(),n=0;n<this._popups.length;n++)this._destroyPopup(n);this._destroyFrame(this._hoverFrame);this._destroyFrame(this._openFrame);Web.HoverMonitor.callBaseMethod(this,"dispose")},nextTabIndex:function(){return this._tabIndex++},_createPopup:function(n){var t,i,r;return this._popups[n]||(t=document.createElement("div"),document.body.appendChild(t),t.className="HoverMenu",Sys.UI.DomElement.setVisible(t,!1),i=$create(AjaxControlToolkit.PopupBehavior,{id:"HoverMonitorPopup"+n},null,null,t),r={behavior:i,container:t},this._popups[n]=r,$addHandlers(t,this._hoverMenuHandlers,this)),this._popups[n]},_destroyPopup:function(n){var t=this._popups[n];t&&(t.behavior.dispose(),$clearHandlers(t.container),t.container.parentNode.removeChild(t.container),delete t.container,delete this._popups[n])},_renderPopup:function(n,t,i,r){var u=new Sys.StringBuilder,l,e,o,h,s,a,f,v;n.container.style.width="";n.container.style.height="";n.container.style.overflow="";n.container.className=String.format("HoverMenu {0}_HoverMenu",r);var y=!1,c=this.get_itemDescriptionStyle(t),p=Web.HoverMonitor.Families[t];if(p){for(l=i?i.get_children():p.items,e=null,o=0;o<l.length;o++)i=l[o],i.get_group()!=e&&(e!=null&&u.append("<\/div>"),e=i.get_group(),e!=null&&u.append('<div class="Group">')),i.get_text()?(h=i.get_selected(),u.append('<a href="javascript:" class="Item'),i.get_cssClass()&&u.append(" "+i.get_cssClass()),h&&u.append(" Selected"),i.get_disabled()&&u.appendFormat(" {0}Disabled Disabled",i.get_cssClass()),u.append('"'),i.get_disabled()?u.append(' onclick2="return false"'):(path=i.get_path(),u.appendFormat(' onclick2="$selectItem(&quot;{0}&quot;,&quot;{1}&quot);return false"',t,path),u.appendFormat(' onmouseover2="$activateItem(&quot;{0}&quot;,&quot;{1}&quot;)" onmouseout2="$deactivateItem(&quot;{0}&quot;,&quot;{1}&quot;)"',t,path)),s=c==Web.ItemDescriptionStyle.None?null:i.get_description(),i.get_children()||s==null||c!=Web.ItemDescriptionStyle.ToolTip||u.appendFormat(' title="{0}"',$appfactory.htmlAttributeEncode(s)),u.appendFormat(' id="{0}"',i.get_id()),u.append(">"),h&&i.get_children()&&u.append('<div class="Parent">'),a=String.htmlEncode(i.get_text()),String.isNullOrEmpty(s)||c!=Web.ItemDescriptionStyle.Inline?u.appendFormat('<span class="Outer"><span class="Inner"><span class="Self">{0}<\/span><\/span><\/span>',a):(y=!0,u.appendFormat('<span class="Outer"><span class="Inner"><span class="Self"><span class="Text">{0}<\/span><span class="Description">{1}<\/span><\/span><\/span><\/span>',a,s)),h&&i.get_children()&&u.append("<\/div>"),u.append("<\/a>"),i.get_dynamic()&&window.setTimeout(i.get_script(),50)):u.append('<div class="Break"><\/div>');e!=null&&u.append("<\/div>")}else return null;for(f=this._factory,f||(f=this._factory=document.createElement("div")),$("a.Item",n.container).unbind("click mouseover mouseout"),f.innerHTML=u.toString(),n.container.innerHTML="",o=0;f.childNodes.length>0;)v=f.childNodes[0],f.removeChild(v),n.container.appendChild(v);return u.clear(),y&&(n.container.className=n.container.className+" "+n.container.className.replace(/(\w+)/g,"$1Ex")),$("a.Item",n.container).mouseover(function(){return __evalEvent.call(this,"mouseover")}).mouseout(function(){return __evalEvent.call(this,"mouseout")}).click(function(){return __evalEvent.call(this,"click")}),n},_createFrame:function(n){var t={top:document.createElement("div"),right:document.createElement("div"),bottom:document.createElement("div"),left:document.createElement("div"),arrow:document.createElement("div")};return t.top.style.position="absolute",t.top.style.display="none",t.top.style.zIndex=n,t.top.className="HoverMonitor_TopLine",document.body.appendChild(t.top),t.right.style.position="absolute",t.right.style.display="none",t.right.style.zIndex=n,t.right.className="HoverMonitor_RightLine",document.body.appendChild(t.right),t.bottom.style.position="absolute",t.bottom.style.display="none",t.bottom.style.zIndex=n,t.bottom.className="HoverMonitor_BottomLine",document.body.appendChild(t.bottom),t.left.style.position="absolute",t.left.style.display="none",t.left.style.zIndex=n,t.left.className="HoverMonitor_LeftLine",document.body.appendChild(t.left),t.arrow.style.position="absolute",t.arrow.style.display="none",t.arrow.style.zIndex=n,t.arrow.className="HoverMonitor_Arrow",document.body.appendChild(t.arrow),t.arrow.innerHTML=String.format('<div style="z-index:{0}"><\/div>',n+1),t},_destroyFrame:function(n){n&&(document.body.removeChild(n.top),delete n.top,document.body.removeChild(n.right),delete n.right,document.body.removeChild(n.bottom),delete n.bottom,document.body.removeChild(n.left),delete n.left,$clearHandlers(n.arrow),document.body.removeChild(n.arrow),delete n.arrow,delete n.element)},get_hoverFrame:function(){return this._hoverFrame||(this._hoverFrame=this._createFrame(Web.HoverMonitor.HoverFrameZIndex),$addHandlers(this._hoverFrame.arrow,this._hoverArrowHandlers,this)),this._hoverFrame},get_openFrame:function(){return this._openFrame||(this._openFrame=this._createFrame(Web.HoverMonitor.OpenFrameZIndex)),this._openFrame},get_hoverItems:function(n){var t=Web.HoverMonitor.Families[n.family];return t?t.items:null},get_hoverStyle:function(n){var t=Web.HoverMonitor.Families[n.family];return t?t.style:Web.HoverStyle.None},get_PopupPosition:function(n){var t=Web.HoverMonitor.Families[n.family];return t?t.position:Web.HoverStyle.Left},get_itemDescriptionStyle:function(n){var t=Web.HoverMonitor.Families[n];return t?t.itemDescriptionStyle:Web.HoverStyle.Inline},get_hoverBounds:function(n){return $appfactory.bounds(n.element)},deactivate:function(n,t){var i=Web.Item.find(n,t),r;i&&(r=$get(i.get_id()),Sys.UI.DomElement.removeCssClass(r,"Active"),this.cancelAutoShow())},get_activeFamily:function(){return this._activeFamily},get_activePath:function(){return this._activePath},get_activeItem:function(){return Web.Item.find(this.get_activeFamily(),this.get_activePath())},get_hoverFamily:function(){var n=this.get_hoverFrame().family;return Web.HoverMonitor.Families[n]},get_openFamily:function(){var n=this.get_openFrame().family;return Web.HoverMonitor.Families[n]},get_isVisible:function(){return this.get_hoverFrame().visible},get_isOpen:function(){return this.get_openFrame()._open},showFrame:function(n,t,i,r){var u,o,e,f,s;r.cssClass=i;r.family=t;r.element=n;Sys.UI.DomElement.addCssClass(n,r.cssClass+"_Hover");u=this.get_hoverBounds(r);Sys.UI.DomElement.setVisible(r.top,!0);r.top.style.width=u.width+"px";r.top.style.left=u.x+"px";r.top.style.top=u.y+"px";r.top.className="HoverMonitor_TopLine "+i+"_TopLine";Sys.UI.DomElement.setVisible(r.right,!0);r.right.style.left=u.x+u.width-1+"px";r.right.style.top=u.y+"px";r.right.style.height=u.height+"px";r.right.className="HoverMonitor_RightLine "+i+"_RightLine";Sys.UI.DomElement.setVisible(r.bottom,!0);r.bottom.style.left=u.x+"px";r.bottom.style.top=u.y+u.height-1+"px";r.bottom.style.width=u.width+"px";r.bottom.className="HoverMonitor_BottomLine "+i+"_BottomLine";Sys.UI.DomElement.setVisible(r.left,!0);r.left.style.left=u.x+"px";r.left.style.top=u.y+"px";r.left.style.height=u.height+"px";r.left.className="HoverMonitor_LeftLine "+i+"_LeftLine";o=Web.HoverMonitor.Families[r.family];o&&(Sys.UI.DomElement.setVisible(r.arrow,!0),r.arrow.className="HoverMonitor_Arrow "+i+"_Arrow",e=Sys.UI.DomElement.getVisible(r.arrow),e||Sys.UI.DomElement.setVisible(r.arrow,!0),f=$appfactory.borderBox(r.arrow),u.width-=f.horizontal,u.height-=f.vertical,s=r.arrow.offsetWidth-f.horizontal,r.arrow.style.top=u.y+1+"px",r.arrow.style.left=u.x+u.width-1-s+"px",r.arrow.style.height=u.height-2+"px",e||Sys.UI.DomElement.setVisible(r.arrow,!1));r.visible=!0},hideFrame:function(n){n.element&&(n.top.className="HoverMonitor_TopLine",Sys.UI.DomElement.setVisible(n.top,!1),n.right.className="HoverMonitor_RightLine",Sys.UI.DomElement.setVisible(n.right,!1),n.bottom.className="HoverMonitor_BottomLine",Sys.UI.DomElement.setVisible(n.bottom,!1),n.left.className="HoverMonitor_LeftLine",Sys.UI.DomElement.setVisible(n.left,!1),n.arrow.className="HoverMonitor_Arrow",n.arrow.style.width="",Sys.UI.DomElement.setVisible(n.arrow,!1),Sys.UI.DomElement.removeCssClass(n.element,n.cssClass+"_Hover"),n.visible=!1)},hidePopups:function(n){var i,r,t;for(n==null&&(n=0),i=n;i<this._popups.length;i++)r=this._popups[i],r&&r.behavior.hide();n==0&&(t=this.get_openFrame(),t._open=!1,t.family=null,t.cssClass=null,delete t.element,this._activeFamily=null,this._activePath=null)},showPopup:function(n,t){var l,c,u,i,y,h,p,nt,b,w,e,a,it,v;this.stopOpen();l=t?t.get_depth()+1:0;this.hidePopups(l);var o=$appfactory.clientBounds(),f=$appfactory.scrolling(),r=this._renderPopup(this._createPopup(l),n.family,t,n.cssClass);if(r){if(c=t?$get(t.get_id()):null,u=c?$appfactory.bounds(c):this.get_hoverBounds(n),t&&(u.x=u.x+u.width+2,u.y=u.y-(u.height-2)),r.behavior.set_x(u.x),r.behavior.set_y(u.y+u.height),r.behavior.show(),c){if(i=$appfactory.bounds(r.container),y=f.x+o.width<i.x+i.width,!y)for(h=l-2;h>=0;h--)if(p=$appfactory.bounds(this._popups[h].container),nt=p.x<i.x&&p.x+p.width>i.x,nt){y=!0;break}u=$appfactory.bounds(c);y&&(u.x=u.x-i.width,u.x>=0&&(r.container.style.left=u.x+"px"))}if(l==0&&Web.PopupPosition.Right==this.get_PopupPosition(n)&&(r.container.style.left=u.x+u.width-$(r.container).outerWidth()+"px"),i=$appfactory.bounds(r.container),i.x+i.width>=f.x+o.width?r.container.style.left=f.x+o.width-i.width+"px":i.x<f.x&&(r.container.style.left=f.x+"px"),i.y+i.height>=f.y+o.height){for(b=!0,w=r.container.getElementsByTagName("div"),h=0;h<w.length;h++)if(e=w[h],e.className=="Group"){var rt=Math.ceil((f.y+o.height-u.y)/5*4),s=$appfactory.bounds(e),tt=s.height<100?s.height:100;if(s.height=rt-(s.y-i.y),s.height<tt?s.height=tt:b=!1,e.offsetHeight>s.height&&(e._autoScrolling=!0,e.style.height=s.height+"px",e.style.overflow="auto",e.style.overflowX="hidden",e.offsetWidth<s.width&&window.external)){var k=e.childNodes[e.childNodes.length-1],d=$appfactory.paddingBox(k),g=$appfactory.borderBox(k);k.style.width=s.width-d.horizontal-g.horizontal+"px"}i=$appfactory.bounds(r.container);break}w=null;b&&(a=u.y+u.height-i.height,a<f.y&&(a=f.y),r.container.style.top=a+"px",a+i.height>f.y+o.height&&(r.container.style.top=f.y+o.height-i.height-2+"px",i=$appfactory.bounds(r.container),i.y<f.y&&(r.container.style.top=f.y+"px",i.height>o.height&&(g=$appfactory.borderBox(r.container),d=$appfactory.paddingBox(r.container),r.container.style.height=o.height-g.vertical-d.vertical+"px",r.container.style.overflow="auto",r.container.style.overflowX="hidden"))),c||(i=$appfactory.bounds(r.container),i.y=u.y-i.height,i.y<f.y&&(it=f.x+o.width-(u.x+u.width),it>=i.width?r.container.style.left=u.x+u.width+"px":(i.x=u.x-i.width,i.x<0&&(i.x=0),r.container.style.left=i.x+"px"),i.y=f.y),r.container.style.top=i.y+"px"))}r.container.style.zIndex=Web.HoverMonitor.HoverMenuZIndex;v=this.get_openFrame();v.family=n.family;v.cssClass=n.cssClass;v.element=n.element;v._open=!0}},hover:function(n,t,i,r){var u=this,e,o,f,s;if(u._hoverElement!=n){for(r==null&&(r=0),u.stopOpen(),u.stopClose();r-->0&&n;)n=n.parentNode;if(e=u.get_hoverFrame(),e.arrow.className="HoverMonitor_Arrow",o=u.get_hoverStyle(u.get_openFrame()),u.hideFrame(u.get_openFrame()),u.showFrame(n,t,i,e),f=u.get_isOpen(),f&&(u.get_hoverFrame().element!=u.get_openFrame().element&&o==Web.HoverStyle.Auto||o==Web.HoverStyle.ClickAndStay)&&u.hidePopups(),u._skipOpen){u._skipOpen=!1;return}s=u.get_hoverStyle(u.get_hoverFrame());s==Web.HoverStyle.Auto?u._hoverTimeout=setTimeout(function(){u._hoverElement=null;u.showPopup(u.get_hoverFrame())},200):f&&s==Web.HoverStyle.ClickAndStay?u.showPopup(u.get_hoverFrame()):f&&u._showOpenFrame()}},_showOpenFrame:function(){var n=this.get_openFrame();this.get_isOpen()&&(n.element||(n=this.get_hoverFrame()),this.showFrame(n.element,n.family,n.cssClass,n))},cancelAutoShow:function(){var n=this;clearTimeout(n._hoverTimeout);n._hoverTimeout=null;n._hoverElement=null},unhover:function(){this._skipUnhover?this._skipUnhover=!1:(this.cancelAutoShow(),this.hideFrame(this.get_hoverFrame()),this.get_isOpen()&&(this.startClose(),this.get_hoverStyle(this.get_openFrame())!=Web.HoverStyle.Click&&this._showOpenFrame()))},select:function(n,t){var u,i,r;try{u=new Sys.UI.DomEvent(window.event);u.stopPropagation();u.preventDefault()}catch(f){}(i=Web.Item.find(n,t),!i.get_confirmation()||confirm(i.get_confirmation()))&&(r=i.get_script(),r?(typeof r=="string"?eval(i.get_script()):r(i.context()),this.close()):String.isNullOrEmpty(i.get_url())||(Web.Menu.navigate(i.get_url()),this.close()))},stopClose:function(){this._closeInterval&&window.clearInterval(this._closeInterval);this._closeInterval=null},startClose:function(){this.stopClose();this._closeInterval=setInterval(function(){var n=Web.HoverMonitor._instance;n.stopClose();n.close()},1e3)},closeItem:function(n,t){this.stopCloseItem();var r=n!=null&&t!=null?Web.Item.find(n,t):this.get_activeItem(),i=this.get_activeItem();r&&i&&(r!=i||!i.get_children())&&this.hidePopups(i.get_depth()+1)},stopCloseItem:function(){this._closeItemInterval&&window.clearInterval(this._closeItemInterval);this._closeItemInterval=null},startCloseItem:function(n,t){this.stopCloseItem();this._closeItemInterval=setInterval(function(){Web.HoverMonitor._instance.closeItem(n,t)},1e3)},stopOpen:function(){this._openInterval&&window.clearInterval(this._openInterval);this._openInterval=null},startOpen:function(n,t){this.stopOpen();this.stopCloseItem();this.stopClose();this._skipStartOpen||(this._openInterval=setInterval(function(){Web.HoverMonitor._instance.open(n,t)},Web.HoverMonitor._instance._tempOpenDelay!=null?Web.HoverMonitor._instance._tempOpenDelay:500),Web.HoverMonitor._instance._tempOpenDelay=null);this._skipStartOpen=!1},open:function(n,t){this.stopOpen();var i=Web.Item.find(n,t);if(i){if(this.hidePopups(i.get_depth()+1),i==null||!i.get_children())return;this.showPopup(this.get_openFrame(),i)}},toggle:function(){if(Web.HoverMonitor._preventToggleHover){Web.HoverMonitor._preventToggleHover=!1;return}if(this.get_isOpen()&&this.get_hoverFrame().family==this.get_openFrame().family){this.hideFrame(this.get_openFrame());this.hidePopups();var n=this.get_hoverFrame();this.showFrame(n.element,n.family,n.cssClass,n)}else this.hideFrame(this.get_openFrame()),this.showPopup(this.get_hoverFrame());this.stopClose()},refresh:function(n){this.get_isOpen()&&this.get_openFrame().family==n&&(this.toggle(),this.toggle())},_hoverArrow_click:function(n){n.preventDefault();n.stopPropagation();this.toggle()},_hoverArrow_mouseover:function(){var n=this.get_hoverFrame();this.showFrame(n.element,n.family,n.cssClass,n)},_hoverArrow_mouseout:function(){this.hideFrame(this.get_hoverFrame());this._showOpenFrame()},close:function(){this.hideFrame(this.get_openFrame());this.hideFrame(this.get_hoverFrame());this.hidePopups()},activate:function(n,t,i){var u,c,r,f,e,o,s,h;for(this._activeFamily=n,this._activePath=t,u=Web.Item.find(n,t),!u||u.get_children()?this.startOpen(n,t):u&&(this.stopOpen(),this.startCloseItem(n,t)),c=!0;u;){if(r=$get(u.get_id()),c&&(c=!1,r)){for(f=r.parentNode,f.className=="Group"&&(f=f.parentNode),e=f.getElementsByTagName("a"),o=0;o<e.length;o++)Sys.UI.DomElement.removeCssClass(e[o],"Active");e=null}r&&Sys.UI.DomElement.addCssClass(r,"Active");i&&r.parentNode._autoScrolling&&(s=$appfactory.bounds(r.parentNode),h=$appfactory.bounds(r),(h.y<s.y||h.y+h.height>s.y+s.height-1)&&r.scrollIntoView(!(i=="down"||i=="end")),r.parentNode.scrollLeft=0);u=u.get_parent()}},_moveToItem:function(n,t){var f;if(n){var u=n.get_parent()?n.get_parent().get_children():Web.HoverMonitor.Families[n.get_family()].items,i=Array.indexOf(u,n),r=null;switch(t){case"down":i=i<u.length-1?i+1:0;break;case"up":i=i>0?i-1:u.length-1;break;case"home":i=0;break;case"end":i=u.length-1}if(r=u[i],r)for(f=i;String.isNullOrEmpty(r.get_text())||r.get_disabled();)if(i+=t=="down"||t=="home"?1:-1,i<0?i=u.length:i>u.length-1&&(i=0),i==f){r=null;break}else r=u[i];r&&($activateItem(r.get_family(),r.get_path(),t),r.get_children()||this.startCloseItem(r.get_family(),r.get_path()))}},_openItem:function(n){n&&n.get_children()&&(this.open(n.get_family(),n.get_path()),n=n.get_children()[0],$activateItem(n.get_family(),n.get_path()))},_openFirstItem:function(){var n=this.get_openFamily();n&&this._moveToItem(n.items[0],"home")},_document_keydown:function(n){var t,r,i,u;if(this.get_isOpen())if(this.stopOpen(),$appfactory._focusedItemIndex=null,t=this.get_activeItem(),t||n.keyCode!=Sys.UI.Key.down&&n.keyCode!=Sys.UI.Key.up){if(n.keyCode==Sys.UI.Key.tab&&!t){if(this.get_hoverStyle(this.get_hoverFrame())==Web.HoverStyle.Auto)return;n.preventDefault();this._openFirstItem()}switch(n.keyCode){case Sys.UI.Key.enter:t&&(String.isNullOrEmpty(t.get_url())&&t.get_children()?this._openItem(t):this.select(t.get_family(),t.get_path()));break;case Sys.UI.Key.esc:if(t&&t.get_parent())this.hidePopups(t.get_depth()),t=t.get_parent(),$activateItem(t.get_family(),t.get_path()),this.stopOpen();else{if(r=this.get_hoverFrame(),i=r.element,this.close(),i){i.tagName.toLowerCase()!="a"&&(u=i.getElementsByTagName("a"),u&&u.length>0&&(i=u[0]),delete u);try{i.focus()}catch(n){}}this._skipOpen=!0;$showHover(r.element,r.family,r.cssClass)}break;case Sys.UI.Key.down:this._moveToItem(t,"down");break;case Sys.UI.Key.up:this._moveToItem(t,"up");break;case Sys.UI.Key.tab:this._moveToItem(t,n.shiftKey?"up":"down");break;case Sys.UI.Key.home:this._moveToItem(t,"home");break;case Sys.UI.Key.end:this._moveToItem(t,"end");break;case Sys.UI.Key.right:case Sys.UI.Key.left:this._openItem(t);break;default:return}n.preventDefault();n.stopPropagation()}else n.preventDefault(),this._openFirstItem();else if(this.get_isVisible())switch(n.keyCode){case Sys.UI.Key.down:case Sys.UI.Key.up:this.get_hoverFamily()&&this.showPopup(this.get_hoverFrame());n.preventDefault()}},_document_click:function(n){if(this._openFrame&&this._openFrame._open){for(var t=n.target;t;){if(!String.isNullOrEmpty(t.className)&&t.className.match(/\s+\w+_Hover/))return;t=t.parentNode}this.close()}},_hoverMenu_mouseover:function(){this.stopClose();this.get_isOpen()&&this.get_hoverStyle(this.get_openFrame())==Web.HoverStyle.Click&&this._showOpenFrame()},_hoverMenu_mouseout:function(){this.startClose()}};Web.HoverMonitor.Families=[];Web.HoverMonitor.registerClass("Web.HoverMonitor",Sys.Component);$.mobile||(Web.HoverMonitor._instance=$create(Web.HoverMonitor,{id:"GlobalHoverMonitor"}));Web.HoverMonitor.OpenFrameZIndex=101001;Web.HoverMonitor.HoverFrameZIndex=101002;Web.HoverMonitor.HoverMenuZIndex=101003;var __ie6=Sys.Browser.agent==Sys.Browser.InternetExplorer&&Sys.Browser.version<7;__ie6&&Sys.UI.DomElement.addCssClass(document.body,"IE6");typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded()